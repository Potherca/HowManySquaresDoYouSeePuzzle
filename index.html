<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    
    <title>How many squares do you see?</title>

    <link href="general.css" rel='stylesheet' type='text/css' />
    <link href="ribbon.css"  rel='stylesheet' type='text/css' />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
</head>
<body>
    <form action="http://fiddle.jshell.net/_display/" method="post" target="jsfiddle-frame" id="fiddle-form"></form>
    <iframe 
        %src="http://jsfiddle.net/gh/get/jquery/1/potherca/HowManySquaresDoYouSeePuzzle/tree/gh-pages/" 
        src="" 
        width="100%" 
        height="100%"
        scrolling="no"
        frameborder="0"
        marginwidth="0"
        marginheight="0"
        hspace="0"
        vspace="0"
        name="jsfiddle-frame"
    >
    </iframe>

	<div class="banner banner-left banner-jsfiddle"><a 
	    href="http://jsfiddle.net/gh/get/jquery/1/potherca/HowManySquaresDoYouSeePuzzle/tree/gh-pages/"
    >Edit me on JsFiddle</a></div>
	
	<div class="banner banner-right"><a 
	    href="https://github.com/potherca/HowManySquaresDoYouSeePuzzle"
    >Fork me on GitHub</a></div>
    
    <script type="text/javascript">
        /**
         * source: http://www.webtoolkit.info/javascript-base64.html
         */
        function base64Encode (input) {
            function utf8_encode (string) {
		        string = string.replace(/\r\n/g,"\n");
		        var utftext = "";
         
		        for (var n = 0; n < string.length; n++) {
         
			        var c = string.charCodeAt(n);
         
			        if (c < 128) {
				        utftext += String.fromCharCode(c);
			        }
			        else if((c > 127) && (c < 2048)) {
				        utftext += String.fromCharCode((c >> 6) | 192);
				        utftext += String.fromCharCode((c & 63) | 128);
			        }
			        else {
				        utftext += String.fromCharCode((c >> 12) | 224);
				        utftext += String.fromCharCode(((c >> 6) & 63) | 128);
				        utftext += String.fromCharCode((c & 63) | 128);
			        }
         
		        }
         
		        return utftext;
	        };
        
            var keyStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";

            var output = "";
            var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
            var i = 0;

            input = utf8_encode(input);

            while (i < input.length) {

                chr1 = input.charCodeAt(i++);
                chr2 = input.charCodeAt(i++);
                chr3 = input.charCodeAt(i++);

                enc1 = chr1 >> 2;
                enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
                enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
                enc4 = chr3 & 63;

                if (isNaN(chr2)) {
                    enc3 = enc4 = 64;
                } else if (isNaN(chr3)) {
                    enc4 = 64;
                }

                output = output +
                keyStr.charAt(enc1) + keyStr.charAt(enc2) +
                keyStr.charAt(enc3) + keyStr.charAt(enc4);

            }

            return output;
        };

        var oData = {
            // @TODO: Read the values below from the demo.details files.
             "js_wrap":"h"
            ,"js_lib":"11"
            ,"js_lib_option":""
            ,"normalize_css":"on"
            ,"panel_css":"0"
            ,"panel_js":"0"
            ,"add_external_resources":""
            ,"title":"How Many Squares Do You See?"
            ,"description":"As just answering without explaining seemed a bit lame I decided I'd rather document my answer."
            ,"author(s)":"Potherca"
            ,"body_tag":"<body>"
            ,"doctype":3
            ,"version":""
            ,"slug":""
            //,"code_html" : '--AJAX FROM ./demo.html --'
            //,"code_js"   : '--AJAX FROM ./js.html --'
            //,"code_css"  : '--AJAX FROM ./css.html --'
        }


        var sContent='';

        $.each(['js','css','html'], function(p_i, p_sName){
            $.get('fiddle/demo.' + p_sName, function(p_sResponseData) {
                sContent = sContent + '<input type="hidden" name="code_' + p_sName + '" value="' + base64Encode(p_sResponseData) + '" />';
                
                if(p_i === 2){                
                    $.each(oData, function(p_sName,p_sValue){
                        sContent = sContent + '<input type="hidden" name="' + p_sName + '" value="' + p_sValue + '" />';
                    });

                    $('#fiddle-form').append(sContent).submit();    
                }
                console.log(p_i);
                console.log(p_sResponseData);
                console.log(base64Encode(p_sResponseData));
            });
        });    
    
    </script>
</body>
</html>


